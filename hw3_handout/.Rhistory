knitr::opts_chunk$set(echo = TRUE, cache=TRUE)
library(tidyverse)
library(IsoformSwitchAnalyzeR)
library(pheatmap)
library(IsoformSwitchAnalyzeR)
packageVersion("IsoformSwitchAnalyzeR")
R.Version()
?importIsoformExpression()
setwd("~/Documents/GitHub/binfHTA/hw3_handout")
importIsoformExpression(parentDir = "./salmon_result_part2")
importIsoformExpression(parentDir = "./salmon_result_part2") %>% importRdata(addAnnotatedORFs=FALSE)
importIsoformExpression(parentDir = "./salmon_result_part2")
IsoformList1 <-  importIsoformExpression(parentDir = "./salmon_result_part2")
head(IsoformList1)
?importRdata
IsoformList1$abundance
IsoformList1$counts
head(IsoformList1$counts,4)
head(IsoformList1)
IsoformList1$length
importRdata(isoformCountMatrix = IsoformList1$counts, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf" )
cuffDB <- prepareCuffExample()
cuffDB
cummeRbund::replicates(cuffDB)
designMatrix <- cummeRbund::replicates(cuffDB)[,c('rep_name','sample_name')]
designMatrix
designMatrix <- cummeRbund::replicates(IsoformList1)[,c('rep_name','sample_name')]
designMatrix <- cummeRbund::replicates(IsoformList1$counts)[,c('rep_name','sample_name')]
OurDesignMatrix <- matrix(c(KO1,KO2,KO3,WT1,WT2,WT3,KO,KO,KO,WT,WT,WT), nrow = 6, ncol=2)
OurDesignMatrix <- matrix(c('KO1','KO2','KO3','WT1','WT2','WT3','KO','KO','KO','WT','WT','WT'), nrow = 6, ncol=2)
OurDesignMatrix
colnames(OurDesignMatrix) <- c('sampleID','condition')
importRdata(isoformCountMatrix = IsoformList1$counts, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
repCount1 <- IsoformList1$counts
importRdata(isoformCountMatrix = repCount1, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
is.atomic(OurDesignMatrix)
OurDesignMatrix <- matrix(as.factor(c('KO1','KO2','KO3','WT1','WT2','WT3','KO','KO','KO','WT','WT','WT')), nrow = 6, ncol=2)
colnames(OurDesignMatrix) <- c('sampleID','condition')
is.atomic(OurDesignMatrix)
importRdata(isoformCountMatrix = repCount1, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
is.matrix(repCount1)
repCount1
repCount1 <- repCountMatrix(IsoformList1$counts)
repCount1 <- repCountMatrix(IsoformList1$counts)
repCount1 <- as.matrix(IsoformList1$counts)
importRdata(isoformCountMatrix = repCount1, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
is.matrix(repCount1)
is.matrix(OurDesignMatrix)
isoRepCount <- repCountMatrix(isoforms(cuffDB))
isoRepCount
isoRepCount$isoform_id <- rownames(isoRepCount)
isoRepCount
repCount1
IsoformList1
IsoformList1$counts
is.matrix(IsoformList1$counts)
repCount1 <- as.matrix(as.number(IsoformList1$counts))
repCount1 <- data.matrix(IsoformList1$counts)
repCount1
repCount1 <- data.matrix(IsoformList1$counts,rownames.force = NA)
?data.matrix
repCount1 <- data.matrix(IsoformList1$counts,rownames.force ="" )
repCount1
repCount1 <- data.matrix(IsoformList1$counts[,2:]
repCount1 <- data.matrix(IsoformList1$counts[,2:8]
repCount1
repCount1 <- data.matrix(IsoformList1$counts[,2:8])
repCount1 <- data.matrix(IsoformList1$counts[,2:7])
repCount1
repCount1$isoform_id <- rownames(isoRepCount)
head(repCount1)
repCount1 <- data.matrix(IsoformList1$counts[,2:7])
repCount1$isoform_id <- rownames(repCount1)
repCount1
repCount1 <- data.matrix(IsoformList1$counts[,2:7])
repCount1
colnames(repCount1) <- c('isoform_id','KO1','KO2','KO3','WT1','WT2','WT3')
repCount1 <- data.matrix(IsoformList1$counts[,2:7])
rownames(repCount1)
repCount1$isoform_id <- rownames(repCount1)
repCount1 <- IsoformList1$counts[,2:7])
repCount1 <- IsoformList1$counts[,2:7]
repCount1$isoform_id <- rownames(repCount1)
repCount1
importRdata(isoformCountMatrix = repCount1, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
OurDesignMatrix <- data.frame(as.factor(c('KO1','KO2','KO3','WT1','WT2','WT3','KO','KO','KO','WT','WT','WT')), nrow = 6, ncol=2)
OurDesignMatrix
OurDesignMatrix <- data.frame(sampleID = c('KO1','KO2','KO3','WT1','WT2','WT3'),condition=c('KO','KO','KO','WT','WT','WT'))
OurDesignMatrix
importRdata(isoformCountMatrix = repCount1, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
My.SwitchAnalyzerRList <-  importRdata(isoformCountMatrix = repCount1, addAnnotatedORFs=FALSE, isoformExonAnnoation = "./salmon_result_part2/subset.gtf",designMatrix = OurDesignMatrix)
My.SwitchAnalyzerRList
summary(My.SwitchAnalyzerRList)
extractSwitchSummary(My.SwitchAnalyzerRList)
My.SwitchAnalyzerRList$isoformFeatures
IsoformList1
head(IsoformList1$counts)
head(IsoformList1$counts[1:2])
head(data.frame(IsoformList1$counts[1:2]))
head(data.frame(IsoformList1$counts[1:7]))
head(data.frame(IsoformList1$counts))
My.SwitchAnalyzerRList$exons
My.SwitchAnalyzerRList$TCONS_00000001
My.SwitchAnalyzerRList$TCONS_0000001
My.SwitchAnalyzerRList
My.SwitchAnalyzerRList$isoformFeatures
head(My.SwitchAnalyzerRList$isoformFeatures,2)
repCount1
